---
import { Image } from "astro:assets";
import { Picture } from "astro:assets";
import type { ImageMetadata } from "astro";

interface Project {
  image: { src: string; alt: string };
  slug: string;
}
interface Props {
  projects: Project[];
}

const { projects } = Astro.props;

const images = import.meta.glob<{ default: ImageMetadata }>(
  "/src/assets/*.{jpeg,jpg,png,gif}"
);

// Check to ensure all images are in the assets folder
projects.forEach((project) => {
  if (!images[project.image.src])
    throw new Error(
      `"${project.image.src}" does not exist in glob: "src/assets/*.{jpeg,jpg,png,gif}"`
    );
});
---

<div class="flex w-full h-full items-center justify-center">
  <div class="relative w-full h-full overflow-hidden">
    <!-- For some reason the white vignette effect don't work in this sandbox but if you uncomment the following lines in VSCode, they should work -->
    <div class="dark:hidden">
      <div
        class="pointer-events-none absolute -top-1 z-10 h-20 w-full bg-gradient-to-b from-stone-100 to-transparent"
      >
      </div>
      <div
        class="pointer-events-none absolute -bottom-1 z-10 h-20 w-full bg-gradient-to-t from-stone-100 to-transparent"
      >
      </div>
      <div
        class="pointer-events-none absolute -left-1 z-10 h-full w-20 bg-gradient-to-r from-stone-100 to-transparent"
      >
      </div>
      <div
        class="pointer-events-none absolute -right-1 z-10 h-full w-20 bg-gradient-to-l from-stone-100 to-transparent"
      >
      </div>
    </div>
    <div class="hidden dark:block">
      <div
        class="pointer-events-none absolute -top-1 z-10 h-20 w-full bg-gradient-to-b from-slate-800 to-transparent"
      >
      </div>
      <div
        class="pointer-events-none absolute -bottom-1 z-10 h-20 w-full bg-gradient-to-t from-slate-800 to-transparent"
      >
      </div>
      <div
        class="pointer-events-none absolute -left-1 z-10 h-full w-20 bg-gradient-to-r from-slate-800 to-transparent"
      >
      </div>
      <div
        class="pointer-events-none absolute -right-1 z-10 h-full w-20 bg-gradient-to-l from-slate-800 to-transparent"
      >
      </div>
    </div>

    <div
      class="items-center justify-center mx-auto grid h-1/2 w-1/2 animate-skew-scroll grid-cols-1 gap-5 sm:w-full sm:grid-cols-2"
    >
      {
        projects.map((project) => (
          <a
            href={project.slug}
            class="flex flex-col justify-center w-full h-full icursor-pointer items-center dark:bg-gray-800 space-x-2 rounded-md border border-gray-100 p-5 shadow-md transition-all hover:-translate-y-1 hover:translate-x-1 hover:scale-[1.025] hover:shadow-xl"
          >
            <div class="flex justify-center items-center">
              <Picture
                src={images[project.image.src]()}
                alt={project.image.alt}
              />
            </div>
          </a>
        ))
      }
    </div>
  </div>
</div>
